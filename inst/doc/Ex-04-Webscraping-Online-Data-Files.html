<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vinh Nguyen" />

<meta name="date" content="2023-10-05" />

<title>Example 4: Webscraping Online Data Files (e.g., CCC Chancellor’s Office Data)</title>

<script src="Ex-04-Webscraping-Online-Data-Files_files/header-attrs-2.14/header-attrs.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

/* A workaround for https://github.com/jgm/pandoc/issues/4278 */
a.sourceLine {
  pointer-events: auto;
}

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link rel="stylesheet" href="C:\Users\vnguyen216\AppData\Local\Temp\RtmpqMlGzD\Rbuild399a061035d55\IRexamples\vignettes\Ex-04-Webscraping-Online-Data-Files_files/style.css" type="text/css" />





</head>

<body>




<header>
<div class="inner">
<h1 class="title toc-ignore">Example 4: Webscraping Online Data Files
(e.g., CCC Chancellor’s Office Data)</h1>
<h3 class="author">Vinh Nguyen</h3>
<h3 class="date">2023-10-05</h3>
</div>
</header>


<div id="TOC" class="toc">
<div class="inner">
<ul>
<li><a href="#introduction-webscraping"
id="toc-introduction-webscraping">Introduction: Webscraping</a></li>
<li><a href="#installation-and-setup"
id="toc-installation-and-setup">Installation and Setup</a>
<ul>
<li><a href="#virtualization-vt-x-in-system-bios"
id="toc-virtualization-vt-x-in-system-bios">Virtualization (VT-x) in
System BIOS</a></li>
<li><a href="#docker-and-selenium-server"
id="toc-docker-and-selenium-server">Docker and Selenium Server</a></li>
<li><a href="#selectorgadget-extension-for-chrome"
id="toc-selectorgadget-extension-for-chrome">SelectorGadget Extension
for Chrome</a></li>
<li><a href="#rselenium-in-r" id="toc-rselenium-in-r">RSelenium in
R</a></li>
<li><a href="#rtools-to-access-the-zip-command-in-windows"
id="toc-rtools-to-access-the-zip-command-in-windows">Rtools to access
the <code>zip</code> command in Windows</a></li>
</ul></li>
<li><a href="#summary-of-webscraping-workflow"
id="toc-summary-of-webscraping-workflow">Summary of Webscraping
Workflow</a></li>
<li><a href="#example-webscrape-scorecard-data-for-all-colleges"
id="toc-example-webscrape-scorecard-data-for-all-colleges">Example:
Webscrape Scorecard Data for All Colleges</a>
<ul>
<li><a href="#exploration-and-strategy"
id="toc-exploration-and-strategy">Exploration and Strategy</a></li>
<li><a href="#execution" id="toc-execution">Execution</a></li>
</ul></li>
<li><a
href="#example-webscrape-student-success-metrics-data-for-all-colleges"
id="toc-example-webscrape-student-success-metrics-data-for-all-colleges">Example:
Webscrape Student Success Metrics Data for All Colleges</a>
<ul>
<li><a href="#exploration-and-strategy-1"
id="toc-exploration-and-strategy-1">Exploration and Strategy</a></li>
<li><a
href="#identifying-the-xpath-of-web-elements-for-clicking-via-selectorgadget"
id="toc-identifying-the-xpath-of-web-elements-for-clicking-via-selectorgadget">Identifying
the <code>XPath</code> of Web Elements for Clicking via
SelectorGadget</a></li>
<li><a
href="#identifying-web-elements-manually-in-chrome-to-fix-some-xpaths"
id="toc-identifying-web-elements-manually-in-chrome-to-fix-some-xpaths">Identifying
Web Elements Manually in Chrome (To Fix Some
<code>XPath</code>’s)</a></li>
<li><a href="#execution-1" id="toc-execution-1">Execution</a></li>
</ul></li>
<li><a href="#exercise-webscrape-data-marts-transfer-velocity-data"
id="toc-exercise-webscrape-data-marts-transfer-velocity-data">Exercise:
Webscrape Data Mart’s Transfer Velocity Data</a></li>
<li><a href="#appendix-r-and-r-package-versions"
id="toc-appendix-r-and-r-package-versions">Appendix: R and R Package
Versions</a></li>
</ul>
</div>
</div>

<div id="content-wrapper">
  <div class="inner clearfix">
    <section id="main-content">
<div id="introduction-webscraping" class="section level1">
<h1>Introduction: Webscraping</h1>
<p>Institutional research (IR) professionals often times rely on
external sources of data in addition to internal data. For example, IR
professionals in the California Community College (CCC) system may be
interested in data provided by the state’s Chancellor’s Office (CO) such
as those on the <a
href="https://www.calpassplus.org/LaunchBoard/Student-Success-Metrics.aspx">Student
Success Metrics</a> (SSM), <a
href="https://datamart.cccco.edu/Default.aspx">Data Mart</a>, <a
href="https://scorecard.cccco.edu/scorecard.aspx">Scorecard</a>, or <a
href="https://www.calpassplus.org/LaunchBoard/Home.aspx">Launchboard</a>.
In addition, they may be interested in data provided by the California
State University (CSU; e.g., the CSU <a
href="https://www.calstate.edu/data-center/institutional-research-analyses/Pages/data-dashboards.aspx">admissions
dashboard</a>) or the University of California (UC; e.g., the UC <a
href="https://www.universityofcalifornia.edu/about-us/information-center/admissions-source-school">admissions
dashboard</a>).</p>
<p>These external data sources provide rich and useful information via
their online interfaces, but sometimes there may be a need to download
the raw data files for the information to be presented in a different
manner, combined with other sources, or analyzed further. For example,
achievement data could be downloaded for all colleges in order for an
institution to benchmark itself against other institutions as this view
is not offered online.</p>
<p>In this vignette, we illustrate how to leverage R to webscrape
(automatically download) online data files. Think of webscraping as
launching a web browser that one could navigate and command using a set
of instructions (code) instead of manually moving the mouse/trackpad and
clicking on links/buttons. Although initially effortful, scripting the
download process allows one to re-run the download process at future
dates with minimal effort. The payoff is especially worthwhile if the
download process involves a lot of files at each run (e.g., 116 files,
one for each CCC, or lots of iterations based on various dropdown menus)
or if the process is recurring (e.g., weekly).</p>
<p>In R, the easiest way to webscrape data is via the <a
href="https://CRAN.R-project.org/package=rvest">rvest</a> package, which
allows one to webscrape html pages. However, this vignette focuses on
the more complicated <a
href="https://CRAN.R-project.org/package=RSelenium">RSelenium</a>
package because it supports pages that utilize javascript
(<code>rvest</code> does not support this), which is quite common on
many websites. Learning how to webscrape using <code>RSelenium</code>
allows one to download data from nearly all sites.</p>
</div>
<div id="installation-and-setup" class="section level1">
<h1>Installation and Setup</h1>
<div id="virtualization-vt-x-in-system-bios" class="section level2">
<h2>Virtualization (VT-x) in System BIOS</h2>
<p>Before we start to webscrape in R using the <a
href="https://CRAN.R-project.org/package=RSelenium">RSelenium</a>
package, we have to enable and install a few hardware and software
dependencies.</p>
<p>First, the user must enable virtualization on their computer by
turning on VT-x in their BIOS. For those not familiar with how to do
this, do a web search for “Computer Make/Model VT-x”. This usually
requires rebooting the computer, entering the BIOS by hitting one of the
function (F#) keys, and navigating to a page that allows the user to
enable VT-x.</p>
<p>What this option does is it allows Windows to run a virtual server on
the system, which is needed for us to launch a virtual server with a web
browser (web driver) that R could control using code.</p>
</div>
<div id="docker-and-selenium-server" class="section level2">
<h2>Docker and Selenium Server</h2>
<p>Download and install <a
href="https://docs.docker.com/get-docker/">Docker Desktop for
Windows</a>, which requires admin rights. For those not familiar, Docker
allows users to install different applications as containers in a
virtual environment. For our use case, this application will be the
Selenium Web Driver in a container, giving us a web browser that we
could control. The installation process should ask the user to restart
their computer to finish the installation process.</p>
<p>On Windows 10, click the start menu and type <em>“Edit local users
and groups”</em>. Go to the <em>“Groups”</em> folder, and navigate to
<em>“docker-users”</em>. Right-click this icon and click <em>“Add to
group…”</em>. Then add your username to this group. This step also
requires admin rights.</p>
<p>On Windows 10, launch <em>“Windows Powershell”</em> from the Start
Menu. Type the following in the terminal to install Firefox in a
Selenium server container inside Docker.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> pull selenium/standalone-firefox:2.53.0</span></code></pre></div>
<!-- ![](./images/Docker_Pull_Selenium.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=14jwBIfLjMmn2qR4a4DheaEer88mGrkCM){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Docker_Pull_Selenium.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280997544_291a3e088f_o.png"
style="width:100.0%" /></p>
<p>The previous command downloads the specified container image. In this
vignette, we pick Firefox over Chrome as it allows for more control in
the browser (navigating and clicking). We stick to a single version,
Firefox 2.53.0, in order to ensure consistency (codes and commands may
be different depending on the version of the browser).</p>
</div>
<div id="selectorgadget-extension-for-chrome" class="section level2">
<h2>SelectorGadget Extension for Chrome</h2>
<p>In order to identify different elements on a webpage for clicking or
selecting dropdown menus, install the <a
href="https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb">SelectorGadget</a>
extension in Chrome (the browser on your computer that you use
regularly, not the one used for webscraping).</p>
</div>
<div id="rselenium-in-r" class="section level2">
<h2>RSelenium in R</h2>
<p>In R, download and install R with the following command:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;RSelenium&#39;</span>, <span class="at">repos=</span><span class="st">&#39;https://cran.r-project.org&#39;</span>)</span></code></pre></div>
</div>
<div id="rtools-to-access-the-zip-command-in-windows"
class="section level2">
<h2>Rtools to access the <code>zip</code> command in Windows</h2>
<p>We will be making use of the <code>makeFirefoxProfile</code> function
from <code>RSelenium</code>, which will require the <code>zip</code>
command to package the results. Most Windows systems do not come with
this command. The easiest way to get access to this is to install <a
href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a> on the
Windows system. For Rtools 4.0 or earlier, remember to <a
href="https://cran.r-project.org/bin/windows/Rtools/rtools40.html">add</a>
the the make utilities into the <code>PATH</code> environment
variable.</p>
</div>
</div>
<div id="summary-of-webscraping-workflow" class="section level1">
<h1>Summary of Webscraping Workflow</h1>
<p>The workflow for scraping data are as follows:</p>
<ol style="list-style-type: decimal">
<li>Launch the Selenium server in Docker via <em>Windows
Powershell</em>.</li>
<li>Start R and load the <code>RSelenium</code> package.</li>
<li>In R, connect to the Selenium server.</li>
<li>In R, visit the site of interest, navigate the page, and download
the necessary files.</li>
<li>Exit R.</li>
<li>Stop Selenium server in Docker via <em>Windows Powershell</em>.</li>
</ol>
<p>This workflow will be leveraged in a few examples in this
vignette.</p>
</div>
<div id="example-webscrape-scorecard-data-for-all-colleges"
class="section level1">
<h1>Example: Webscrape Scorecard Data for All Colleges</h1>
<div id="exploration-and-strategy" class="section level2">
<h2>Exploration and Strategy</h2>
<p>In this example, we illustrate how to download each college’s data
file on the CCC <a
href="https://scorecard.cccco.edu/scorecard.aspx">Scorecard</a>. That
is, the goal is to download the data provided for each college present
in the college dropdown, as shown here:</p>
<!-- ![](./images/Scorecard_College_Dropdown.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1ug0Cs1hBP2dSimQuVjRnuDdKyeplAZAr){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Scorecard_College_Dropdown.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280733271_4a7feee145_o.png"
style="width:100.0%" /></p>
<p>Before going into technical details, let’s first explore the site and
formulate a strategy. On the <a
href="https://scorecard.cccco.edu/scorecard.aspx">Scorecard</a> site,
select one college. We’ll select <em>Irvine Valley College</em> for
illustration. The browser should take the visitor to the following
page:</p>
<!-- ![](./images/Scorecard_IVC.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1ppbhd_r8zNzw-Kgbx-cgjlrFc1bmc30l){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Scorecard_IVC.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52281215570_5f9cc90a12_o.png"
style="width:100.0%" /></p>
<p>There are two things worth noting:</p>
<ol style="list-style-type: decimal">
<li>The URL listed in the browser is now
<code>https://scorecard.cccco.edu/scorecardrates.aspx?CollegeID=892</code>.
Irvine Valley College (IVC) has <code>CollegeID=892</code> in this URL.
For those not familiar, this is the district/college code assigned to
IVC by the state, as used in all MIS data submissions. A list of the
district/college codes can be found <a
href="https://webdata.cccco.edu/ded/DistrictCollegeCodes.pdf">here</a>.</li>
<li>To download the data file, scroll to the bottom, and notice the
<em>Five Year</em> download button, as seen below. The button has the
URL
<code>https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=892</code>,
and clicking it downloads a file named
<code>892_FiveYear.xlsx</code>.</li>
</ol>
<!-- ![](./images/Scorecard_Download_Button.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=13g2aR0bTwRkucxSN4z3wqIZv9pQDr7Oo){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Scorecard_Download_Button.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280748213_f0894fb04f_o.png"
style="width:100.0%" /></p>
<p>Now, recall the goal is to download the aforementioned excel file for
all colleges. Based on the previous exploration, one could download the
files by repeatedly visiting the URL
<code>https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=YYY</code>,
where we change <code>YYY</code> to be various college codes. A general
webscraping strategy is as follows:</p>
<ol style="list-style-type: decimal">
<li>Obtain the list of college ID’s from <a
href="https://webdata.cccco.edu/ded/DistrictCollegeCodes.pdf">here</a>,
and make it accessible in R.</li>
<li>In R, construct the various URL’s of interest based on the previous
list.</li>
<li>Visit the URL’s generated in the previous step to download the many
excel files.</li>
</ol>
<p>In the next section, we’ll put this strategy into action with R and
<code>RSelenium</code>.</p>
</div>
<div id="execution" class="section level2">
<h2>Execution</h2>
<p>Launch <em>Windows Powershell</em> from the Start Menu. Then run the
following command in the terminal.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">-v</span> ~/Downloads/Selenium-Downloads/://home/seluser/Downloads <span class="at">-p</span> 4445:4444 <span class="at">-p</span> 5901:5900 selenium/standalone-firefox:2.53.0</span></code></pre></div>
<p>The previous command has a few parameters worth noting:</p>
<ul>
<li><code>docker run</code> is the command to run an application.</li>
<li><code>selenium/standalone-firefox:2.53.0</code> is the application
to run.</li>
<li>Forward port 4444 and 5900 on the virtual server to ports 4445 and
5901, respectively, on the host computer (the user’s computer). In R, we
will connect to <code>localhost</code> (host computer) on port 4445,
which will connect to the virtual server on port 4444.</li>
<li>Map the virtual server’s download folder,
<code>/home/seluser/Downloads</code>, to the host computer’s download
folder, <code>~/Downloads/Selenium-Downloads</code>, where
<code>~</code> refers to <code>C:/Users/USERNAME</code> and
<code>USERNAME</code> is the username of the current user on the Windows
system. This mapping allows files to be downloaded to Selenium’s default
folder, <code>/home/seluser/Downloads</code>, which will be accessible
for the user at
<code>C:/Users/USERNAME/Downloads/Selenium-Downloads</code>.</li>
</ul>
<p>The <em>Windows Powershell</em> terminal should look similar to the
following after running the command:</p>
<!-- ![](./images/Docker_Run.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1VZIZQOuWVHfWrR4fXVq33aV4RtAabcmH){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Docker_Run.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52279750352_c79f0d50b9_o.png"
style="width:100.0%" /></p>
<p>Next, let’s launch R. In R, we create a Firefox profile, and connect
to the Selenium Web Driver / Server using the following code:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSelenium)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Firefox profile</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>fprof <span class="ot">&lt;-</span> <span class="fu">makeFirefoxProfile</span>(<span class="fu">list</span>(<span class="at">browser.download.dir=</span><span class="st">&#39;/home/seluser/Downloads&#39;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                 , <span class="at">browser.download.folderList=</span>2L</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                 , <span class="at">browser.download.manager.showWhenStarting=</span><span class="cn">FALSE</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                                 , <span class="at">browser.helperApps.neverAsk.saveToDisk=</span><span class="st">&#39;text/csv;application/vnd.ms-excel;application/zip&#39;</span> <span class="co"># This says if a CSV/XLS/XLSX/ZIP is encountered, then download file automatically into default download folder</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># See MIME Types here: https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                                 ))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remote driver</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>remDr <span class="ot">&lt;-</span> <span class="fu">remoteDriver</span>(<span class="at">browserName=</span><span class="st">&#39;firefox&#39;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">port=</span>4445L</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">extraCapabilities=</span>fprof</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">remoteServerAddr=</span><span class="st">&#39;localhost&#39;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ## If the user wants to use chrome, they will also need to download the Chrome version of Selenium</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="do">## remDr &lt;- remoteDriver(browserName=&#39;chrome&#39;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="do">##                       , port=4445L</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                       , remoteServerAddr=&#39;localhost&#39;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="do">##                       , extraCapabilities=list(chromeOptions=list(prefs=list(&#39;profile.default_content_settings.popups&#39;=0L, &#39;download.prompt_for_download&#39;=FALSE, &#39;download.default_directory&#39;=&#39;/home/seluser/Downloads&#39;))) # https://stackoverflow.com/questions/35504731/specify-download-folder-in-rselenium</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="do">##                         )</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect to selenium server</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">open</span>()</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Connecting to remote server&quot;</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="do">## $applicationCacheEnabled</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="do">## $rotatable</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] FALSE</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="do">## $handlesAlerts</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="do">## $databaseEnabled</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="do">## $version</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;45.0.2&quot;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="do">## $platform</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;LINUX&quot;</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="do">## $nativeEvents</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] FALSE</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="do">## $acceptSslCerts</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="do">## $webdriver.remote.sessionid</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;6a53fec1-485f-4834-98b1-b5e1ac651615&quot;</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="do">## $webStorageEnabled</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="do">## $locationContextEnabled</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="do">## $browserName</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;firefox&quot;</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a><span class="do">## $takesScreenshot</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="do">## $javascriptEnabled</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a><span class="do">## $cssSelectorsEnabled</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="do">## $id</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;6a53fec1-485f-4834-98b1-b5e1ac651615&quot;</span></span></code></pre></div>
<p>Before constructing the URL’s of the excel files and visiting those
links, let’s first explore some basics of <code>RSelenium</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># URL</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>scorecard_url <span class="ot">&lt;-</span> <span class="st">&#39;https://scorecard.cccco.edu/scorecard.aspx&#39;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visit URL</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">navigate</span>(scorecard_url)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get title of page</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">getTitle</span>()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;2019 Student Success Scorecard&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a screenshot of the current page, to confirm we are on the right page</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remDr$screenshot(display=TRUE) # Running this should open up an image of the page in a browser</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">screenshot</span>(<span class="at">file=</span><span class="st">&#39;RSelenium_Screenshot_Scorecard.png&#39;</span>)</span></code></pre></div>
<p>Running the <code>remDr$screenshot(display=TRUE)</code> line should
open up the following in an image viewer:</p>
<!-- ![](./images/RSelenium_Screenshot_Scorecard.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1TbGwqOU8d9sIOSgtEjtI1-njw4Ug2sAu){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/RSelenium_Screenshot_Scorecard.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52281215640_391b80d119_o.png"
style="width:100.0%" /></p>
<p>The screenshot function is especially useful during the development
phase of the script as it allows one to debug the process by viewing
what the browser looks like. Whenever code errors out or when things
don’t go as planned, debug the problematic steps with the screenshot
function.</p>
<p>Next, let’s construct the URL’s of the excel files and visit those
URL’s. First, to obtain the list of college ID’s, download <a
href="https://webdata.cccco.edu/ded/DistrictCollegeCodes.pdf">this</a>
file, and open the PDF file in MS Word. After the conversion in MS Word,
the user should have a table that could be highlighted, copied, and
pasted into MS Excel. After doing so, the college codes are extracted
and specified in R as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>college_codes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;611&#39;</span>, <span class="st">&#39;621&#39;</span>, <span class="st">&#39;911&#39;</span>, <span class="st">&#39;111&#39;</span>, <span class="st">&#39;411&#39;</span>, <span class="st">&#39;811&#39;</span>, <span class="st">&#39;482&#39;</span>, <span class="st">&#39;481&#39;</span>, <span class="st">&#39;921&#39;</span>, <span class="st">&#39;821&#39;</span>, <span class="st">&#39;831&#39;</span>, <span class="st">&#39;832&#39;</span>, <span class="st">&#39;833&#39;</span>, <span class="st">&#39;711&#39;</span>, <span class="st">&#39;311&#39;</span>, <span class="st">&#39;312&#39;</span>, <span class="st">&#39;313&#39;</span>, <span class="st">&#39;971&#39;</span>, <span class="st">&#39;931&#39;</span>, <span class="st">&#39;721&#39;</span>, <span class="st">&#39;121&#39;</span>, <span class="st">&#39;421&#39;</span>, <span class="st">&#39;422&#39;</span>, <span class="st">&#39;441&#39;</span>, <span class="st">&#39;731&#39;</span>, <span class="st">&#39;021&#39;</span>, <span class="st">&#39;022&#39;</span>, <span class="st">&#39;451&#39;</span>, <span class="st">&#39;031&#39;</span>, <span class="st">&#39;521&#39;</span>, <span class="st">&#39;522&#39;</span>, <span class="st">&#39;523&#39;</span>, <span class="st">&#39;221&#39;</span>, <span class="st">&#39;131&#39;</span>, <span class="st">&#39;841&#39;</span>, <span class="st">&#39;748&#39;</span>, <span class="st">&#39;741&#39;</span>, <span class="st">&#39;742&#39;</span>, <span class="st">&#39;743&#39;</span>, <span class="st">&#39;744&#39;</span>, <span class="st">&#39;745&#39;</span>, <span class="st">&#39;746&#39;</span>, <span class="st">&#39;747&#39;</span>, <span class="st">&#39;749&#39;</span>, <span class="st">&#39;231&#39;</span>, <span class="st">&#39;232&#39;</span>, <span class="st">&#39;234&#39;</span>, <span class="st">&#39;233&#39;</span>, <span class="st">&#39;334&#39;</span>, <span class="st">&#39;335&#39;</span>, <span class="st">&#39;141&#39;</span>, <span class="st">&#39;531&#39;</span>, <span class="st">&#39;051&#39;</span>, <span class="st">&#39;461&#39;</span>, <span class="st">&#39;851&#39;</span>, <span class="st">&#39;941&#39;</span>, <span class="st">&#39;241&#39;</span>, <span class="st">&#39;861&#39;</span>, <span class="st">&#39;862&#39;</span>, <span class="st">&#39;863&#39;</span>, <span class="st">&#39;431&#39;</span>, <span class="st">&#39;951&#39;</span>, <span class="st">&#39;061&#39;</span>, <span class="st">&#39;771&#39;</span>, <span class="st">&#39;341&#39;</span>, <span class="st">&#39;345&#39;</span>, <span class="st">&#39;343&#39;</span>, <span class="st">&#39;344&#39;</span>, <span class="st">&#39;872&#39;</span>, <span class="st">&#39;871&#39;</span>, <span class="st">&#39;873&#39;</span>, <span class="st">&#39;161&#39;</span>, <span class="st">&#39;881&#39;</span>, <span class="st">&#39;962&#39;</span>, <span class="st">&#39;963&#39;</span>, <span class="st">&#39;961&#39;</span>, <span class="st">&#39;981&#39;</span>, <span class="st">&#39;982&#39;</span>, <span class="st">&#39;076&#39;</span>, <span class="st">&#39;071&#39;</span>, <span class="st">&#39;078&#39;</span>, <span class="st">&#39;072&#39;</span>, <span class="st">&#39;073&#39;</span>, <span class="st">&#39;361&#39;</span>, <span class="st">&#39;363&#39;</span>, <span class="st">&#39;551&#39;</span>, <span class="st">&#39;471&#39;</span>, <span class="st">&#39;472&#39;</span>, <span class="st">&#39;641&#39;</span>, <span class="st">&#39;371&#39;</span>, <span class="st">&#39;372&#39;</span>, <span class="st">&#39;373&#39;</span>, <span class="st">&#39;651&#39;</span>, <span class="st">&#39;652&#39;</span>, <span class="st">&#39;661&#39;</span>, <span class="st">&#39;781&#39;</span>, <span class="st">&#39;561&#39;</span>, <span class="st">&#39;171&#39;</span>, <span class="st">&#39;271&#39;</span>, <span class="st">&#39;181&#39;</span>, <span class="st">&#39;281&#39;</span>, <span class="st">&#39;261&#39;</span>, <span class="st">&#39;892&#39;</span>, <span class="st">&#39;891&#39;</span>, <span class="st">&#39;091&#39;</span>, <span class="st">&#39;571&#39;</span>, <span class="st">&#39;572&#39;</span>, <span class="st">&#39;576&#39;</span>, <span class="st">&#39;681&#39;</span>, <span class="st">&#39;682&#39;</span>, <span class="st">&#39;683&#39;</span>, <span class="st">&#39;991&#39;</span>, <span class="st">&#39;581&#39;</span>, <span class="st">&#39;582&#39;</span>, <span class="st">&#39;691&#39;</span>, <span class="st">&#39;492&#39;</span>, <span class="st">&#39;493&#39;</span>, <span class="st">&#39;591&#39;</span>, <span class="st">&#39;592&#39;</span>, <span class="st">&#39;292&#39;</span>, <span class="st">&#39;291&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>scorecard_download_base_url <span class="ot">&lt;-</span> <span class="st">&#39;https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=&#39;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(college_codes)) {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:2) { ## Use this to test first two colleges</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(scorecard_download_base_url, college_codes[i]) <span class="co"># Create URL</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(current_url, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>) <span class="co"># Print URL</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  remDr<span class="sc">$</span><span class="fu">navigate</span>(current_url) <span class="co"># Navigate to URL</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">5</span>) <span class="co"># Pause for 5 seconds before continuing</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=611 </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=621 </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=911 </span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=111 </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=411 </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=811 </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=482 </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=481 </span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=921 </span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=821 </span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=831 </span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=832 </span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=833 </span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=711 </span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=311 </span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=312 </span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=313 </span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=971 </span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=931 </span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=721 </span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=121 </span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=421 </span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=422 </span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=441 </span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=731 </span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=021 </span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=022 </span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=451 </span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=031 </span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=521 </span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=522 </span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=523 </span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=221 </span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=131 </span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=841 </span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=748 </span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=741 </span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=742 </span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=743 </span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=744 </span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=745 </span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=746 </span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=747 </span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=749 </span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=231 </span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=232 </span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=234 </span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=233 </span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=334 </span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=335 </span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=141 </span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=531 </span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=051 </span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=461 </span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=851 </span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=941 </span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=241 </span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=861 </span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=862 </span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=863 </span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=431 </span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=951 </span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=061 </span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=771 </span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=341 </span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=345 </span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=343 </span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=344 </span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=872 </span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=871 </span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=873 </span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=161 </span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=881 </span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=962 </span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=963 </span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=961 </span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=981 </span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=982 </span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=076 </span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=071 </span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=078 </span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=072 </span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=073 </span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=361 </span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=363 </span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=551 </span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=471 </span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=472 </span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=641 </span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=371 </span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=372 </span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=373 </span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=651 </span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=652 </span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=661 </span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=781 </span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=561 </span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=171 </span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=271 </span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=181 </span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=281 </span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=261 </span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=892 </span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=891 </span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=091 </span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=571 </span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=572 </span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=576 </span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=681 </span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=682 </span></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=683 </span></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=991 </span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=581 </span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=582 </span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=691 </span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=492 </span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=493 </span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=591 </span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=592 </span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=292 </span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a><span class="do">## https://scorecard.cccco.edu/fiveyear.aspx?CollegeID=291 </span></span></code></pre></div>
<p>After the above code completes, the user should see the downloaded
files at <code>C:\Users\USERNAME\Downloads\Selenium-Downloads</code> on
the host computer, as seen below:</p>
<!-- ![](./images/Scorecard_Downloaded_Files.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1gFKy9plEvyO93ldkfQYxleotDfPj6XeO){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Scorecard_Downloaded_Files.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280997379_521f6d45dc_o.png"
style="width:100.0%" /></p>
<p>The user could now close R, then run the following command in
<em>Windows Powershell</em> terminal to stop Selenium Server in
Docker:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> stop <span class="va">$(</span><span class="ex">docker</span> ps <span class="at">-q</span><span class="va">)</span> <span class="co"># to stop when done</span></span></code></pre></div>
<p>The terminal should look similar to the following:</p>
<!-- ![](./images/Docker_Stop.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1AnKQhUwRrdx3KN30mc5bPtP29jKUodcT){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Docker_Stop.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280997504_e41fdebbc1_o.png"
style="width:100.0%" /></p>
<p>This completes the first example.</p>
</div>
</div>
<div
id="example-webscrape-student-success-metrics-data-for-all-colleges"
class="section level1">
<h1>Example: Webscrape Student Success Metrics Data for All
Colleges</h1>
<div id="exploration-and-strategy-1" class="section level2">
<h2>Exploration and Strategy</h2>
<p>In this next example, we seek to download all data files from the <a
href="https://www.calpassplus.org/LaunchBoard/Student-Success-Metrics.aspx">Student
Success Metrics</a>. The page should look like the following:</p>
<!-- ![](./images/SSM_Landing_Page.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1s7lHmfZTDOYoXX5NTIUTfzbVOk-xA5gI){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SSM_Landing_Page.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280748013_b0dd2e364d_o.png"
style="width:100.0%" /></p>
<p>If one were to click the <em>All Students</em> journey, then the
<em>College</em> radio button, then <em>Irvine Valley College</em> from
the dropdown menu, then the <em>View</em> button, the page would look as
follows:</p>
<!-- ![](./images/SSM_All_Students_College.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=17HKesFqAdqBFnumVQ2u-l2ENIVfR3RpL){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SSM_All_Students_College.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52279750107_3181b1fc1c_o.png"
style="width:100.0%" /></p>
<p>Notice the <em>Export Data to CSV</em> button. If one were to click
on that button, the browser would attempt to save the file
<code>StudentSuccessMetrics_AllStudents_IrvineValleyCollege.csv</code>.
At the time this vignette was written, there was a spinning wheel shown
on the page for about 10 seconds before the download prompt appeared.
This suggests that the download does not occur immediately, and that it
would be a good idea to incorporate a pause of at least 10 seconds after
this button is pressed to ensure a file is downloaded.</p>
<p>Let’s inspect the downloaded file. Notice the name of the CSV file
that was generated. Both the journey type and the name of the college
are specified in the file name. If one were to open this file, it
becomes apparent that this file contains data for the specified journey
type and institution for all years, disaggregation, and metrics. Thus,
to download all files, one just needs to focus on the <em>Journey
Type</em> and the <em>College</em> dropdown menus.</p>
<p>Next, let’s change the <em>Journey Type</em> dropdown to
“Degree/Transfer Students”, then click the <em>View</em> button. It took
about 3 seconds for the page to refresh. Thus, whenever one changes the
dropdown menu and click the <em>View</em> button, it might be a good
idea to pause for at least 5 seconds to ensure the page refreshes.</p>
<p>One thing to note so far is that the URL in the address has not
changed and remained the same through all the clicking:
<code>https://www.calpassplus.org/LaunchBoard/Student-Success-Metrics</code>.
This is quite different from the previous example. For the
technically-inclined, the page is executing javascript code through all
the navigation. This is the reason why the <code>RSelenium</code>
package is needed because the Selenium Web Driver is able to evaluate
and execute javascript code.</p>
<p>Based on what we learned so far, the following strategy will allow us
to download all CSV files for different college and journey type
combinations:</p>
<ol style="list-style-type: decimal">
<li>Visit the Student Success Metrics page:
<code>https://www.calpassplus.org/LaunchBoard/Student-Success-Metrics</code>.</li>
<li>Wait for 2 seconds so the page could load.</li>
<li>Click the <em>All Students</em> journey type.</li>
<li>Wait for 5 seconds so the page could load.</li>
<li>Click the <em>College</em> radio button. “Allan Hancock College” is
populated in the dropdown by default.</li>
<li>Determine the number of items in the <em>College</em> dropdown
menu.</li>
<li>Determine the number of items in the <em>Journey Type</em> dropdown
menu.</li>
<li>Create a <em>for</em> loop that cycles through the number of items
in the <em>College</em> dropdown menu.</li>
<li>Create a <em>for</em> loop that cycles through the number of items
in the <em>Journey Type</em> dropdown menu.</li>
<li>Select the appropriate <em>College</em> and <em>Journey
Type</em>.</li>
<li>Click the <em>View</em> button.</li>
<li>Wait for 6 seconds.</li>
<li>Click the <em>Export Data to CSV</em> button.</li>
<li>Wait for 10 seconds so the CSV file downloads.</li>
<li>Repeat steps 10-14 for the remaining items in the <em>College</em>
and <em>Journey Type</em> dropdown menus.</li>
</ol>
</div>
<div
id="identifying-the-xpath-of-web-elements-for-clicking-via-selectorgadget"
class="section level2">
<h2>Identifying the <code>XPath</code> of Web Elements for Clicking via
SelectorGadget</h2>
<p>The strategy outlined previously requires the user to specify the
clicking of various links or buttons on the page. The way that users
could identify different locations on a page is via <a
href="https://en.wikipedia.org/wiki/XPath">XPath</a>. In a nutshell, one
could use the <em>SelectorGadget</em> extension in Chrome to highlight a
location of interest, and the extension would then provide the
<code>XPath</code> of that location. Think of <code>XPath</code> as an
address or unique identifier to the element of interest on the page.
This <code>XPath</code> location could then be passed to
<code>RSelenium</code> for Selenium to identify the location or web
element of interest, and the user could then interact with this element
(e.g., clicking the element, pressing the down keyboard button to scroll
through a dropdown menu, etc.).</p>
<p>To illustrate, let’s revisit the main SSM <a
href="https://www.calpassplus.org/LaunchBoard/Student-Success-Metrics">page</a>.
Scroll to the location of interest, which in our case, would be the
<em>All Students</em> link. Click the <em>SelectorGadget</em> extension
in Chrome (icon at the top in the extensions section), then move the
mouse over the <em>All Students</em> link (the picture box). Click the
link. At the bottom where the extension is shown, click the
<code>XPath</code> button, and the <code>XPath</code> should display.
These two steps should look like the following:</p>
<!-- ![](./images/SelectorGadget_All_Students.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1W3XMDGVEpOvxxLqe5Mt6zI3zsmlFVDLY){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SelectorGadget_All_Students.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280733206_95d2e66992_o.png"
style="width:100.0%" /></p>
<!-- ![](./images/SelectorGadget_All_Students_XPath.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1j9ECnkS2r5Fqu_xIs_GlIp1szrXK0s72){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SelectorGadget_All_Students_XPath.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52281215555_b8bdd4a40c_o.png"
style="width:100.0%" /></p>
<p>The extension should then show the <code>XPath</code> to be:</p>
<pre><code>//*[contains(concat( &quot; &quot;, @class, &quot; &quot; ), concat( &quot; &quot;, &quot;grey&quot;, &quot; &quot; ))]</code></pre>
<p>Turn off the <em>SelectorGadget</em> extension by clicking on its
icon at the top. Let’s click the <em>All Students</em> link. After the
page loads, let’s identify the <code>XPath</code> of the
<em>College</em> radio button at the top:</p>
<!-- ![](./images/SelectorGadget_College_Button.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1_340v2gITEI4NhUHrXw0p9mZvficQK6A){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SelectorGadget_College_Button.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280997294_dfdac06245_o.png"
style="width:100.0%" /></p>
<p>Turn off the <em>SelectorGadget</em> extension by clicking on its
icon at the top, then click the <em>College</em> radio button. Let’s
identify the <code>XPath</code> of the <em>View</em> button at the
top:</p>
<!-- ![](./images/SelectorGadget_View_Button.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1_PBAj_DMFWWppZvv2L75pEcNYKZ4Q8Ar){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SelectorGadget_View_Button.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280748038_c4bd4ffe6f_o.png"
style="width:100.0%" /></p>
<p>Click <em>Clear</em> in the <em>SelectorGadget</em> extension at the
bottom. Let’s identify the <code>XPath</code> of the <em>Export Data to
CSV</em> button at the top:</p>
<!-- ![](./images/SelectorGadget_Export.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1mHu3avxkBnmnnjOLrQgJB56EhXhskjYy){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SelectorGadget_Export.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280997264_79c0275a60_o.png"
style="width:100.0%" /></p>
<p>Click <em>Clear</em> in the <em>SelectorGadget</em> extension at the
bottom. Let’s identify the <code>XPath</code> of the <em>Journey
Type</em> and <em>College</em> dropdown menus at the top:</p>
<!-- ![](./images/SelectorGadget_Journey_Type_Dropdown.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=19ipWAZ74yAF0WZ67QQkufwMTL5nxUvnj){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SelectorGadget_Journey_Type_Dropdown.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52281215490_76501fc93c_o.png"
style="width:100.0%" /></p>
<!-- ![](./images/SelectorGadget_College_Dropdown.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1TNdp4dH0TUNbWxVG0zCh7daflCo9rsqE){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/SelectorGadget_College_Dropdown.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280733126_357e8645a4_o.png"
style="width:100.0%" /></p>
<p>We now have all the <code>XPath</code> locations of the links we need
to execute the plan illustrated in the previous section:</p>
<pre><code>## All Students link
//*[contains(concat( &quot; &quot;, @class, &quot; &quot; ), concat( &quot; &quot;, &quot;grey&quot;, &quot; &quot; ))]

## College Radio Button
//*[(@id = &quot;collegeFilterBtn&quot;)]

## View Button
//*[(@id = &quot;view&quot;)]

## Export Button
//*[(@id = &quot;export&quot;)]

## Journey Type Dropdown
//*[(@id = &quot;select2-pgmDD-container&quot;)]

## College Dropdown
//*[(@id = &quot;select2-schoolDD-container&quot;)]</code></pre>
</div>
<div id="identifying-web-elements-manually-in-chrome-to-fix-some-xpaths"
class="section level2">
<h2>Identifying Web Elements Manually in Chrome (To Fix Some
<code>XPath</code>’s)</h2>
<p>If one were to try to click on the <em>All Students</em> link from
the previous section in Selenium, the one with the following
<code>XPath</code>,</p>
<pre><code>## All Students link
//*[contains(concat( &quot; &quot;, @class, &quot; &quot; ), concat( &quot; &quot;, &quot;grey&quot;, &quot; &quot; ))]</code></pre>
<p>then the following error would be returned from Selenium:</p>
<pre><code>Selenium message:Element is not currently visible and so may not be interacted with
Build info: version: &#39;2.53.1&#39;, revision: &#39;a36b8b1&#39;, time: &#39;2016-06-30 17:37:03&#39;
System info: host: &#39;9c06e0e28e14&#39;, ip: &#39;172.17.0.2&#39;, os.name: &#39;Linux&#39;, os.arch: &#39;amd64&#39;, os.version: &#39;4.9.184-linuxkit&#39;, java.version: &#39;1.8.0_91&#39;
Driver info: driver.version: unknown

Error:   Summary: ElementNotVisible
     Detail: An element command could not be completed because the element is not visible on the page.
     class: org.openqa.selenium.ElementNotVisibleException
     Further Details: run errorDetails method</code></pre>
<p>The reason for this is because the <code>XPath</code> provided by
SelectorGadget is actually incorrect or not unique to that <em>All
Students</em> link (NOTE: this rarely happens, and this is the author’s
first time encountering an incorrect <code>XPath</code> from
SelectorGadget; this is due to some recent updates to the SSM page). To
get the correct link, one could do a manual inspection in the Chrome
browser to identify the correct ID.</p>
<p>First, while on the SSM <a
href="https://www.calpassplus.org/LaunchBoard/Student-Success-Metrics">page</a>,
press <em>Ctrl + Shift + J</em> on the keyboard to bring up
<em>Developer Tools</em>, as seen here:</p>
<!-- ![](./images/Chrome_Developer_Tools.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=14aRr0aOkTUXY16JtzBTzDBjig0oTj7uz){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Chrome_Developer_Tools.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280997619_5daec0a206_o.png"
style="width:100.0%" /></p>
<p>Then select the <em>Select an Element</em> icon in the top left
(assisted by a box in red), or press <em>Ctrl + Shift + C</em>, to be
able to select an element on the page and see results:</p>
<!-- ![](./images/Chrome_Select_An_Element.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=11B0Zu5vBREMLLJZDSFd94Rv8YXx8PqD7){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Chrome_Select_An_Element.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52279750412_77745ca995_o.png"
style="width:100.0%" /></p>
<p>Move the mouse cursor over the <em>All Students</em> link and click
it for the console to show a description of it, as seen here:</p>
<!-- ![](./images/Chrome_Select_All_Students.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1bo1P9z5gbyKPE15aZTflh04FAgRzKv2j){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/Chrome_Select_All_Students.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280733416_ca620eb64f_o.png"
style="width:100.0%" /></p>
<p>Notice that the link has an ID of <code>journeyBox5</code>. Similar
to the College radio button, View button, and Export button before, the
<code>Xpath</code> for the <em>All Students</em> could be specified with
the following:</p>
<pre><code>## All Students Link
//*[(@id = &quot;journeyBox5&quot;)]</code></pre>
<p>This <code>XPath</code> should be used to refer to the <em>All
Students</em> link.</p>
</div>
<div id="execution-1" class="section level2">
<h2>Execution</h2>
<p>Let’s now execute the plan formulated previously, incorporating the
<code>XPath</code>’s found in the previous sections.</p>
<p>First, we start Selenium Server in Docker via <em>Windows
Powershell</em>.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-d</span> <span class="at">-v</span> ~/Downloads/Selenium-Downloads/://home/seluser/Downloads <span class="at">-p</span> 4445:4444 <span class="at">-p</span> 5901:5900 selenium/standalone-firefox:2.53.0</span></code></pre></div>
<p>Then, we launch R, and set things up with the following code:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSelenium)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Firefox profile</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>fprof <span class="ot">&lt;-</span> <span class="fu">makeFirefoxProfile</span>(<span class="fu">list</span>(<span class="at">browser.download.dir=</span><span class="st">&#39;/home/seluser/Downloads&#39;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                                 , <span class="at">browser.download.folderList=</span>2L</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                 , <span class="at">browser.download.manager.showWhenStarting=</span><span class="cn">FALSE</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                 , <span class="at">browser.helperApps.neverAsk.saveToDisk=</span><span class="st">&#39;text/csv;application/vnd.ms-excel;application/zip&#39;</span> <span class="co"># This says if a CSV/XLS/XLSX/ZIP is encountered, then download file automatically into default download folder</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># See MIME Types here: https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                 ))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remote driver</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>remDr <span class="ot">&lt;-</span> <span class="fu">remoteDriver</span>(<span class="at">browserName=</span><span class="st">&#39;firefox&#39;</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">port=</span>4445L</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">extraCapabilities=</span>fprof</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">remoteServerAddr=</span><span class="st">&#39;localhost&#39;</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ## If the user wants to use chrome, they will also need to download the Chrome version of Selenium</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="do">## remDr &lt;- remoteDriver(browserName=&#39;chrome&#39;</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="do">##                       , port=4445L</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                       , remoteServerAddr=&#39;localhost&#39;</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="do">##                       , extraCapabilities=list(chromeOptions=list(prefs=list(&#39;profile.default_content_settings.popups&#39;=0L, &#39;download.prompt_for_download&#39;=FALSE, &#39;download.default_directory&#39;=&#39;/home/seluser/Downloads&#39;))) # https://stackoverflow.com/questions/35504731/specify-download-folder-in-rselenium</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="do">##                         )</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect to selenium server</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">open</span>()</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Connecting to remote server&quot;</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="do">## $applicationCacheEnabled</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="do">## $rotatable</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] FALSE</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="do">## $handlesAlerts</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="do">## $databaseEnabled</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="do">## $version</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;45.0.2&quot;</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="do">## $platform</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;LINUX&quot;</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="do">## $nativeEvents</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] FALSE</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="do">## $acceptSslCerts</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="do">## $webdriver.remote.sessionid</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;01849a37-6c21-47c7-af04-9d8b4a2cab31&quot;</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="do">## $webStorageEnabled</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="do">## $locationContextEnabled</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="do">## $browserName</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;firefox&quot;</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="do">## $takesScreenshot</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="do">## $javascriptEnabled</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a><span class="do">## $cssSelectorsEnabled</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a><span class="do">## $id</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;01849a37-6c21-47c7-af04-9d8b4a2cab31&quot;</span></span></code></pre></div>
<p>Next, we implement the plan previously outlined.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># URL</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ssm_url <span class="ot">&lt;-</span> <span class="st">&#39;https://www.calpassplus.org/LaunchBoard/Student-Success-Metrics.aspx&#39;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visit URL</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">navigate</span>(ssm_url)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get title of page</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">getTitle</span>()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Cal-PASS Plus - Student-Success-Metrics&quot;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a screenshot of the current page, to confirm we are on the right page</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="do">## remDr$screenshot(display=TRUE) # Running this should open up an image of the page in a browser</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Locate and click the &quot;All Students&quot; journey button</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>all_students_button_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//*[(@id = &quot;journeyBox5&quot;)]&#39;</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>all_students_button_elem<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Pause</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Locate college radio button and click</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>college_button_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//*[(@id = &quot;collegeFilterBtn&quot;)]&#39;</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>college_button_elem<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Select View to refresh: defaults to All Students, Allan Hancock</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>view_button_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//*[(@id = &quot;view&quot;)]&#39;</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>view_button_elem<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Pause</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co"># remDr$screenshot(display=TRUE) # Running this should open up an image of the page in a browser</span></span></code></pre></div>
<p>At this step, running the screenshot function should show the
following:</p>
<!-- ![](./images/RSelenium_Screenshot_View_Button.png){width=100%} -->
<!-- ![](https://drive.google.com/uc?export=view&id=1BMdgiKBMBSEL5nnsjHi987dYWgcRvyMU){width=100%} -->
<!-- ![](http://www.nguyenvq.com/img/IRexamples/RSelenium_Screenshot_View_Button.png){width=100%} -->
<p><img
src="https://live.staticflickr.com/65535/52280997424_53f49e6cc6_o.png"
style="width:100.0%" /></p>
<p>Next, we identify the remaining buttons and determine the values in
the dropdown menus of interest.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify Export button</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>export_button_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//*[(@id = &quot;export&quot;)]&#39;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># export_button_elem$clickElement()</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify Journey Type</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>journey_dropdown_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//*[(@id = &quot;select2-pgmDD-container&quot;)]&#39;</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># journey_dropdown_elem$clickElement()</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify College Dropdown</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>college_dropdown_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//*[(@id = &quot;select2-schoolDD-container&quot;)]&#39;</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># college_dropdown_elem$clickElement()</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain values in dropdown menus</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab ID&#39;s from previous: pgmDD and schoolDD</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>journey_select_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//select[@id=&quot;pgmDD&quot;]&#39;</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>college_select_elem <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using=</span><span class="st">&#39;xpath&#39;</span>, <span class="st">&#39;//select[@id=&quot;schoolDD&quot;]&#39;</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>opts_journey <span class="ot">&lt;-</span> journey_select_elem<span class="sc">$</span><span class="fu">selectTag</span>()</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>opts_college <span class="ot">&lt;-</span> college_select_elem<span class="sc">$</span><span class="fu">selectTag</span>()</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>opts_journey<span class="sc">$</span>text</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;All Students&quot;                                          &quot;Adult Education/English as a Second Language Students&quot;</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [3] &quot;Short-Term Career Students&quot;                            &quot;Degree/Transfer Students&quot;                             </span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [5] &quot;Undecided Students&quot;                                   </span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>opts_journey<span class="sc">$</span>value</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>opts_college<span class="sc">$</span>text</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="do">##   [1] &quot;Allan Hancock College&quot;             &quot;American River College&quot;            &quot;Antelope Valley College&quot;          </span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="do">##   [4] &quot;Bakersfield College&quot;               &quot;Barstow College&quot;                   &quot;Berkeley City College&quot;            </span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="do">##   [7] &quot;Butte College&quot;                     &quot;Cabrillo College&quot;                  &quot;Cañada College&quot;                   </span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  [10] &quot;Cerritos College&quot;                  &quot;Cerro Coso Community College&quot;      &quot;Chabot College&quot;                   </span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  [13] &quot;Chaffey College&quot;                   &quot;Citrus College&quot;                    &quot;City College of San Francisco&quot;    </span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  [16] &quot;Clovis Community College&quot;          &quot;Coastline Community College&quot;       &quot;College of Alameda&quot;               </span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  [19] &quot;College of Marin&quot;                  &quot;College of San Mateo&quot;              &quot;College of the Canyons&quot;           </span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  [22] &quot;College of the Desert&quot;             &quot;College of the Redwoods&quot;           &quot;College of the Sequoias&quot;          </span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  [25] &quot;College of the Siskiyous&quot;          &quot;Columbia College&quot;                  &quot;Compton College&quot;                  </span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="do">##  [28] &quot;Contra Costa College&quot;              &quot;Copper Mountain Community College&quot; &quot;Cosumnes River College&quot;           </span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  [31] &quot;Crafton Hills College&quot;             &quot;Cuesta College&quot;                    &quot;Cuyamaca College&quot;                 </span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="do">##  [34] &quot;Cypress College&quot;                   &quot;De Anza College&quot;                   &quot;Diablo Valley College&quot;            </span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  [37] &quot;East Los Angeles College&quot;          &quot;El Camino College&quot;                 &quot;Evergreen Valley College&quot;         </span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="do">##  [40] &quot;Feather River College&quot;             &quot;Folsom Lake College&quot;               &quot;Foothill College&quot;                 </span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="do">##  [43] &quot;Fresno City College&quot;               &quot;Fullerton College&quot;                 &quot;Gavilan College&quot;                  </span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="do">##  [46] &quot;Glendale Community College&quot;        &quot;Golden West College&quot;               &quot;Grossmont College&quot;                </span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a><span class="do">##  [49] &quot;Hartnell College&quot;                  &quot;Imperial Valley College&quot;           &quot;Irvine Valley College&quot;            </span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="do">##  [52] &quot;Lake Tahoe Community College&quot;      &quot;Laney College&quot;                     &quot;Las Positas College&quot;              </span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  [55] &quot;Lassen College&quot;                    &quot;Long Beach City College&quot;           &quot;Los Angeles City College&quot;         </span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a><span class="do">##  [58] &quot;Los Angeles Harbor College&quot;        &quot;Los Angeles ITV&quot;                   &quot;Los Angeles Mission College&quot;      </span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="do">##  [61] &quot;Los Angeles Pierce College&quot;        &quot;Los Angeles Southwest College&quot;     &quot;Los Angeles Trade-Tech College&quot;   </span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a><span class="do">##  [64] &quot;Los Angeles Valley College&quot;        &quot;Los Medanos College&quot;               &quot;Marin Continuing&quot;                 </span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="do">##  [67] &quot;Mendocino College&quot;                 &quot;Merced College&quot;                    &quot;Merritt College&quot;                  </span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a><span class="do">##  [70] &quot;MiraCosta College&quot;                 &quot;Mission College&quot;                   &quot;Modesto Junior College&quot;           </span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a><span class="do">##  [73] &quot;Monterey Peninsula College&quot;        &quot;Moorpark College&quot;                  &quot;Moreno Valley College&quot;            </span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a><span class="do">##  [76] &quot;Mt. San Antonio College&quot;           &quot;Mt. San Jacinto College&quot;           &quot;Napa Valley College&quot;              </span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a><span class="do">##  [79] &quot;Norco College&quot;                     &quot;North Orange Adult&quot;                &quot;Ohlone College&quot;                   </span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="do">##  [82] &quot;Orange Coast College&quot;              &quot;Oxnard College&quot;                    &quot;Palo Verde College&quot;               </span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a><span class="do">##  [85] &quot;Palomar College&quot;                   &quot;Pasadena City College&quot;             &quot;Porterville College&quot;              </span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a><span class="do">##  [88] &quot;Rancho Santiago CED&quot;               &quot;Reedley College&quot;                   &quot;Rio Hondo College&quot;                </span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a><span class="do">##  [91] &quot;Riverside City College&quot;            &quot;Sacramento City College&quot;           &quot;Saddleback College&quot;               </span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a><span class="do">##  [94] &quot;San Bernardino Valley College&quot;     &quot;San Diego Adult&quot;                   &quot;San Diego City College&quot;           </span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a><span class="do">##  [97] &quot;San Diego Mesa College&quot;            &quot;San Diego Miramar College&quot;         &quot;San Francisco Centers&quot;            </span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a><span class="do">## [100] &quot;San Joaquin Delta College&quot;         &quot;San Jose City College&quot;             &quot;Santa Ana College&quot;                </span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a><span class="do">## [103] &quot;Santa Barbara City College&quot;        &quot;Santa Barbara Continuing&quot;          &quot;Santa Monica College&quot;             </span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a><span class="do">## [106] &quot;Santa Rosa Junior College&quot;         &quot;Santiago Canyon College&quot;           &quot;Shasta College&quot;                   </span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a><span class="do">## [109] &quot;Sierra College&quot;                    &quot;Skyline College&quot;                   &quot;Solano Community College&quot;         </span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a><span class="do">## [112] &quot;Southwestern College&quot;              &quot;Taft College&quot;                      &quot;Ventura College&quot;                  </span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a><span class="do">## [115] &quot;Victor Valley College&quot;             &quot;West Hills College Coalinga&quot;       &quot;West Hills College Lemoore&quot;       </span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="do">## [118] &quot;West Los Angeles College&quot;          &quot;West Valley College&quot;               &quot;Woodland Community College&quot;       </span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a><span class="do">## [121] &quot;Yuba College&quot;                     </span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>opts_college<span class="sc">$</span>value</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="do">##   [1] &quot;96&quot;  &quot;97&quot;  &quot;98&quot;  &quot;99&quot;  &quot;100&quot; &quot;101&quot; &quot;102&quot; &quot;103&quot; &quot;104&quot; &quot;105&quot; &quot;106&quot; &quot;107&quot; &quot;108&quot; &quot;109&quot; &quot;110&quot; &quot;111&quot; &quot;112&quot; &quot;113&quot; &quot;114&quot;</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="do">##  [20] &quot;115&quot; &quot;116&quot; &quot;117&quot; &quot;118&quot; &quot;119&quot; &quot;120&quot; &quot;121&quot; &quot;122&quot; &quot;123&quot; &quot;124&quot; &quot;125&quot; &quot;126&quot; &quot;127&quot; &quot;128&quot; &quot;129&quot; &quot;130&quot; &quot;131&quot; &quot;132&quot; &quot;133&quot;</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="do">##  [39] &quot;134&quot; &quot;135&quot; &quot;136&quot; &quot;137&quot; &quot;138&quot; &quot;139&quot; &quot;140&quot; &quot;141&quot; &quot;142&quot; &quot;143&quot; &quot;144&quot; &quot;145&quot; &quot;146&quot; &quot;147&quot; &quot;148&quot; &quot;149&quot; &quot;150&quot; &quot;151&quot; &quot;152&quot;</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="do">##  [58] &quot;153&quot; &quot;154&quot; &quot;155&quot; &quot;156&quot; &quot;157&quot; &quot;158&quot; &quot;159&quot; &quot;160&quot; &quot;161&quot; &quot;162&quot; &quot;163&quot; &quot;164&quot; &quot;165&quot; &quot;166&quot; &quot;167&quot; &quot;168&quot; &quot;169&quot; &quot;170&quot; &quot;171&quot;</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="do">##  [77] &quot;172&quot; &quot;173&quot; &quot;174&quot; &quot;175&quot; &quot;176&quot; &quot;177&quot; &quot;178&quot; &quot;179&quot; &quot;180&quot; &quot;181&quot; &quot;182&quot; &quot;183&quot; &quot;184&quot; &quot;185&quot; &quot;186&quot; &quot;187&quot; &quot;188&quot; &quot;189&quot; &quot;190&quot;</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="do">##  [96] &quot;191&quot; &quot;192&quot; &quot;193&quot; &quot;194&quot; &quot;195&quot; &quot;196&quot; &quot;197&quot; &quot;198&quot; &quot;199&quot; &quot;200&quot; &quot;201&quot; &quot;202&quot; &quot;203&quot; &quot;204&quot; &quot;205&quot; &quot;206&quot; &quot;207&quot; &quot;208&quot; &quot;209&quot;</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="do">## [115] &quot;210&quot; &quot;211&quot; &quot;212&quot; &quot;213&quot; &quot;214&quot; &quot;215&quot; &quot;216&quot;</span></span></code></pre></div>
<p>Based on the previous results, there are <code>121</code> colleges
and <code>5</code> journeys to cycle through. Let’s now proceed with two
<em>for</em> loops to iterate through each combination and download
export the files:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(opts_college<span class="sc">$</span>text)) { <span class="do">## use this for full run</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:2) { ## use this to test first two colleges</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 21:121) { ## if process breaks in the middle, start with remDr$open() above, and re-run; in this line, start with the college number that errored out to continue download</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;i: &#39;</span>, i, <span class="st">&#39;, College: &#39;</span>, opts_college<span class="sc">$</span>text[i], <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select college</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  opts_college<span class="sc">$</span>elements[[i]]<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(opts_journey<span class="sc">$</span>text)) {</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;j: &#39;</span>, j, <span class="st">&#39;, Journey: &#39;</span>, opts_journey<span class="sc">$</span>text[j], <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select journey</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    opts_journey<span class="sc">$</span>elements[[j]]<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click View button</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    view_button_elem<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">6</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Click Export button</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    export_button_elem<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">10</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Other approaches: pressing down and enter on keyboard to cycle through dropdown menus.</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   college_dropdown_elem$clickElement()</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   college_dropdown_elem$sendKeysToActiveElement(list(key=&#39;down_arrow&#39;))</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   college_dropdown_elem$sendKeysToActiveElement(list(key=&#39;enter&#39;))</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  1 , College:  Allan Hancock College </span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  2 , College:  American River College </span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  3 , College:  Antelope Valley College </span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  4 , College:  Bakersfield College </span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  5 , College:  Barstow College </span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  6 , College:  Berkeley City College </span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  7 , College:  Butte College </span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  8 , College:  Cabrillo College </span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  9 , College:  Cañada College </span></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  10 , College:  Cerritos College </span></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  11 , College:  Cerro Coso Community College </span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  12 , College:  Chabot College </span></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  13 , College:  Chaffey College </span></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  14 , College:  Citrus College </span></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  15 , College:  City College of San Francisco </span></span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  16 , College:  Clovis Community College </span></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  17 , College:  Coastline Community College </span></span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  18 , College:  College of Alameda </span></span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  19 , College:  College of Marin </span></span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  20 , College:  College of San Mateo </span></span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Students </span></span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  4 , Journey:  Degree/Transfer Students </span></span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  5 , Journey:  Undecided Students </span></span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a><span class="do">## i:  21 , College:  College of the Canyons </span></span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  1 , Journey:  All Students </span></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  2 , Journey:  Adult Education/English as a Second Language Students </span></span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a><span class="do">## j:  3 , Journey:  Short-Term Career Student</span></span></code></pre></div>
<p>The above code should save the CSV files on the host computer’s
<code>C:/Users/USERNAME/Downloads/Selenium-Downloads</code> folder.</p>
<p>Whenever a webscrape script downloads many files on a particular
website, there is a always the possibility that the script will error
out, either through the web server timing out the connection because it
detects a user (or robot) downloading many files, or the steps in the
script causes an error through the various navigations (e.g., not
pausing long enough for the page or data to load). When this happens,
the user could continue the script where the error happened by
re-running the entire webscrape script, but modifying the
<code>for</code> loop to start where the error occurred. For example, if
the error happened at <code>i=21</code>, then the user could start the
loop at 21 similar to the following code:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in seq_along(opts_college$text)) { ## use this for full run</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:2) { ## use this to test first two colleges</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">121</span>) { <span class="do">## if process breaks in the middle, start with remDr$open() above, and re-run; in this line, start with the college number that errored out to continue download</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## continue with other code</span></span></code></pre></div>
<p>If the previous solution causes an error at the same step, then
something else may be going on. The user is advised to investigate with
the screenshot function and to manually test in an actual web
browser.</p>
<p>After downloading all files, the user could now close R, then run the
following command in <em>Windows Powershell</em> terminal to stop
Selenium Server in Docker:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> stop <span class="va">$(</span><span class="ex">docker</span> ps <span class="at">-q</span><span class="va">)</span> <span class="co"># to stop when done</span></span></code></pre></div>
<p>This completes the second example.</p>
</div>
</div>
<div id="exercise-webscrape-data-marts-transfer-velocity-data"
class="section level1">
<h1>Exercise: Webscrape Data Mart’s Transfer Velocity Data</h1>
<p>As an exercise, the reader is encouraged to write a script to
download the <a
href="https://datamart.cccco.edu/Outcomes/Transfer_Velocity.aspx">Transfer
Velocity</a> data files for all colleges.</p>
</div>
<div id="appendix-r-and-r-package-versions" class="section level1">
<h1>Appendix: R and R Package Versions</h1>
<p>This vignette was generated using an R session with the following
packages. There may be some discrepancies when the reader replicates the
code caused by version mismatch.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">## R version 4.0.2 (2020-06-22)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Running under: Windows 10 x64 (build 17763)</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrix products: default</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## locale:</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [4] LC_NUMERIC=C                           LC_TIME=English_United States.1252    </span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="do">## attached base packages:</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="do">## other attached packages:</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] RSelenium_1.7.7      RevoUtils_11.0.2     RevoUtilsMath_11.0.0</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="do">## loaded via a namespace (and not attached):</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] Rcpp_1.0.6       XML_3.99-0.6     binman_0.1.2     assertthat_0.2.1 bitops_1.0-7     R6_2.5.0        </span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] jsonlite_1.7.2   semver_0.2.0     httr_1.4.2       curl_4.3.1       tools_4.0.2      wdman_0.2.5     </span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] tinytex_0.32     xfun_0.23        compiler_4.0.2   askpass_1.1      caTools_1.18.2   openssl_1.4.4  </span></span></code></pre></div>
</div>
    </section>
  </div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
